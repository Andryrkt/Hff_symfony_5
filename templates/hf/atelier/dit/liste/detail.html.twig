{% extends 'base.html.twig' %}

{% block title %}Détail BADM
	{{dom.numeroBadm}}
{% endblock %}

{% import "macros/affiche.html.twig" as macroForm %}
{% import "macros/form_macros.html.twig" as formMacro %}

{% block content %}
<div class=" container mt-3">
	<div class="card mb-3">
		<div class="card-body">

			<class="container">
				<div class="row">
					{# DEBUT DIT #}
					<div class="col-12 col-md-6">
						{{ formMacro.sousTitre('DIT', {class: 'sousTitre'})}}
						<div class="row">
							<div class="col-12 col-md-4">{{ macroForm.affichage('Numero DIT', dto.numeroDit)}}</div>
							<div class="col-12 col-md-4">{{ macroForm.affichage('Date Demande', dto.dateDemande|date('d/m/Y'))}}</div>
							<div class="col-12 col-md-4">{{ macroForm.affichage('Statut DIT', dto.statutDemande.description)}}</div>
						</div>
						<div class="row">
							<div class="col-12">{{ macroForm.affichage('Objet de la demande', dto.objetDemande)}}</div>
							<div class="col-12">{{ macroForm.affichage('Détail de la demande', dto.detailDemande)}}</div>
						</div>
						<div class="row">
							<div class="col-12 col-md-4">{{ macroForm.affichage('Type de document', dto.typeDocument.description)}}</div>
							<div class="col-12 col-md-4">{{ macroForm.affichage('Demande de devis', dto.demandeDevis)}}</div>
							<div class="col-12 col-md-4">{{ macroForm.affichage('Livraison Partielle', dto.livraisonPartiel)}}</div>
						</div>
						<div class="row">
							<div class="col-12 col-md-4">{{ macroForm.affichage('Avis de recouvrement', dto.avisRecouvrement)}}</div>
							<div class="col-12 col-md-4">{{ macroForm.affichage('Catégorie de demande', dto.categorieDemande.libelleCategorieAteApp)}}</div>
							<div class="col-12 col-md-4">{{ macroForm.affichage('Interne et Externe', dto.internetExterne)}}</div>
						</div>
					</div>
					{# FIN DIT #}
					{# DEBUT OR #}
					<div class="col-12 col-md-3">
						{{ formMacro.sousTitre('Or', {class: 'sousTitre'})}}
						<div class="row">
							<div class="col-12 col-md-6">

								{{ macroForm.affichage('N° Or', dto.numeroOr)}}
							</div>
							<div class="col-12 col-md-6">{{ macroForm.affichage('Statut Or', dto.statutOr)}}</div>
							{% set mots_a_supprimer = ['Chef section', 'Chef de section', 'Responsable section', 'Chef d\'équipe'] %}
								<div class="col-12 col-md-12">{{ macroForm.affichage('Section affectée', dto.sectionAffectee | remove_words(mots_a_supprimer) )}}</div>
							</div>
						</div>
						{# FIN OR #}
						{# DEBUT Commande #}
						<div class="col-12 col-md-3">
							{{ formMacro.sousTitre('Commande', {class: 'sousTitre'})}}
							<table class="table rounded mt-1">
								<thead class="table">
									<tr>
										<th>N°</th>
										<th>Date</th>
										<th>Statut</th>
									</tr>
								</thead>
								<tbody>

									{% for command in dto.commandes %}
										<tr>
											<td>{{ command.slor_numcf}}</td>
											<td>{{ command.fcde_date | date("d/m/Y")}}</td>
											<td>
												--
											</td>
										</tr>
									{% endfor %}
								</tbody>
							</table>
						</div>
						{# FIN Commande#}
					</div>


					<div class="row">
						<div
							class="col-12 col-md-6">
							{# DEBUT Agence et service #}
							{{ formMacro.sousTitre('Agence et Service', {class: 'sousTitre'})}}
							<div class="row">
								<div class="col-12 col-md-6">
									{{ macroForm.affichage('Débiteur', dto.debiteur.agence.code ~ ' - ' ~ dto.debiteur.service.code)}}
								</div>
								<div class="col-12 col-md-6">
									{{ macroForm.affichage('Emetteur', dto.emetteur.agence.code ~ ' - ' ~ dto.emetteur.service.code)}}
								</div>
							</div>
							{# FIN Agence et service #}
							{# DEBUT Info Client #}

							{{ formMacro.sousTitre('Info Client', {class: 'sousTitre'})}}
							<div class="row">
								<div class="col-12 col-md-4">
									{{ macroForm.affichage('Nom du client', dto.nomClient)}}
								</div>
								<div class="col-12 col-md-4">
									{{ macroForm.affichage('N° téléphone', dto.numeroTel)}}
								</div>
								<div class="col-12 col-md-4">
									{{ macroForm.affichage('Client sous contrat', dto.clientSousContrat)}}
								</div>
							</div>
							{# FIN Info Client #}

							{# DEBUT CARACTERISTIQUE MACHINE #}
							{{ formMacro.sousTitre('Information Matériel', {class: 'sousTitre'})}}
							<div class="row">
								<div class="col-12 col-md-4">
									{{ macroForm.affichage('Id Materiel', dto.idMateriel)}}
								</div>
								<div class="col-12 col-md-4">
									{{ macroForm.affichage('n° Serie', dto.numSerie)}}
								</div>
								<div class="col-12 col-md-4">
									{{ macroForm.affichage('n° Parc', dto.numParc)}}
								</div>
							</div>
							<div>
								<div class="row">
									<div class="col-12 col-md-6">
										{{ macroForm.affichage('Constructeur', dto.constructeur)}}
										{{ macroForm.affichage('Designation', dto.designation)}}
										{{ macroForm.affichage('Km', dto.km)}}
									</div>
									<div class="col-12 col-md-6">
										{{ macroForm.affichage('Modele', dto.modele)}}
										{{ macroForm.affichage('Casier', dto.casier)}}
										{{ macroForm.affichage('Heure', dto.heure)}}
									</div>
								</div>
							</div>
							{# FIN CARACTERISTIQUE MACHINE#}

							{# DEBUT Bilan financière#}
							{{ formMacro.sousTitre('Bilan Financière', {class: 'sousTitre mb-3'})}}
							<div class="cadre">
								<div class="row">
									<div class="col-12 col-md-6">
										{{ macroForm.affichage('CA', dto.chiffreAffaire | number_format(2, ',', '.'))}}
										{{ macroForm.affichage('Charge d\'entretien', dto.chargeEntretient | number_format(2, ',', '.'))}}
                                        {{ macroForm.affichage('Charge Locative', dto.chargeLocative | number_format(2, ',', '.'))}}
                                        {{ macroForm.affichage('Résultat d\'exploitation', dto.resultatExploitation | number_format(2, ',', '.'))}}
									</div>
									<div class="col-12 col-md-6">
										{{ macroForm.affichage('Coût d\'acquisition', dto.coutAcquisition | number_format(2, ',', '.'))}}
                                    	{{ macroForm.affichage('Amortissement', dto.amortissement | number_format(2, ',', '.'))}}
                                        {{ macroForm.affichage('VNC', dto.valeurNetComptable | number_format(2, ',', '.'))}}
									</div>
								</div>
						</div>
					</div>
						{# FIN Bilan #}

						{# DEBUT INTERVENTION#}
					<div class="col-12 col-md-6">
						{{ formMacro.sousTitre('Intervention', {class: 'sousTitre'})}}
						<div class="row">
							<div class="col-12 col-md-6">
								{{ macroForm.affichage('Niveau d\'urgence', dto.niveauUrgence.code)}}
									</div>
									<div class="col-12 col-md-6">
										{{ macroForm.affichage('Date prévu travaux', dto.datePrevueTravaux|date('d/m/Y'))}}
									</div>
								</div>
								{{ formMacro.sousTitre('Réparation', {class: 'sousTitre'})}}
								<div class="row">
									<div class="col-12 col-md-6">
										{{ macroForm.affichage('Type de réparation',  dto.typeReparation)}}
									</div>
									<div class="col-12 col-md-6">
										{{ macroForm.affichage('Réparation réalisé par', dto.reparationRealise)}}
									</div>
								</div>
								{# FIN INTERVENTION#}

								{# DEBUT PIECE JOINTE#}
								{{ formMacro.sousTitre('Pièces Jointes', {class: 'sousTitre'})}}

								{{ macroForm.affichageFile('Pièce jointe 01', dto.pieceJoint01, "/Upload/dit/fichier")}}

								{{ macroForm.affichageFile('Pièce jointe 02', dto.pieceJoint02, "/Upload/dit/fichier")}}

								{{ macroForm.affichageFile('Pièce jointe 03', dto.pieceJoint03, "/Upload/dit/fichier")}}
								{# FIN PIECE JOINTE #}
					</div>
				</div>
			</div>
		</div>
	</div>

	<div id="materielInfos"></div>
{% endblock %}