<turbo-frame id="user_access_list_for_user_{{ user.id }}">
	{% if accesses is defined and accesses|length > 0 %}
		<div class="access-list-container">
			<h6>Liste des accès pour
				{{ user.fullname }}</h6>
			<div class="table-responsive">
				<table class="table table-sm table-bordered">
					<thead class="table-light">
						<tr>
							<th>ID</th>
							<th>Nom de l'accès</th>
							<th>Description</th>
							<th>Actions</th>
						</tr>
					</thead>
					<tbody>
						{% for access in accesses %}
							<tr>
								<td>{{ access.id }}</td>
								<td>{{ access.name }}</td>
								<td>{{ access.description ?? 'N/A' }}</td>
								<td>
									<button class="btn btn-sm btn-outline-danger" data-action="click->user-access#removeAccess" data-user-access-user-id="{{ user.id }}" data-user-access-id="{{ access.id }}">
										Retirer
									</button>
								</td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>

			{# Formulaire pour ajouter un accès #}
			<div class="mt-3">
				<h6>Ajouter un accès</h6>
				{{ form_start(form, {'attr': {'data-turbo-frame': 'user_access_list_for_user_' ~ user.id}}) }}
				<div class="row g-2 align-items-center">
					<div class="col-md-3">
						{{ form_widget(form.agence, {'attr': {'class': 'form-select form-select-sm'}}) }}
					</div>
					<div class="col-md-3">
						{{ form_widget(form.service, {'attr': {'class': 'form-select form-select-sm'}}) }}
					</div>
					<div class="col-md-3">
						{{ form_widget(form.typeDocument, {'attr': {'class': 'form-select form-select-sm'}}) }}
					</div>
					<div class="col-md-12">
						<div class="form-check form-check-inline">
							{{ form_widget(form.allAgence) }}
							{{ form_label(form.allAgence) }}
						</div>
						<div class="form-check form-check-inline">
							{{ form_widget(form.allService) }}
							{{ form_label(form.allService) }}
						</div>
					</div>
					<div class="col-md-12">
						{{ form_widget(form.permissions, {'attr': {'class': 'form-select form-select-sm', 'style': 'height: 100px'}}) }}
					</div>
					<div class="col-auto mt-2">
						<button type="submit" class="btn btn-sm btn-success">Ajouter</button>
					</div>
				</div>
				{{ form_end(form) }}
			</div>
		</div>
	{% else %}
		<div class="text-center py-3">
			<p class="text-muted mb-3">Aucun accès attribué à cet utilisateur.</p>

			{# Formulaire pour ajouter un accès #}
			<div class="mt-3">
				<h6>Ajouter un accès</h6>
				{{ form_start(form, {'attr': {'data-turbo-frame': 'user_access_list_for_user_' ~ user.id}}) }}
				<div class="row g-2 align-items-center justify-content-center">
					<div class="col-md-3">
						{{ form_widget(form.agence, {'attr': {'class': 'form-select form-select-sm'}}) }}
					</div>
					<div class="col-md-3">
						{{ form_widget(form.service, {'attr': {'class': 'form-select form-select-sm'}}) }}
					</div>
					<div class="col-md-3">
						{{ form_widget(form.typeDocument, {'attr': {'class': 'form-select form-select-sm'}}) }}
					</div>
					<div class="col-md-12">
						<div class="form-check form-check-inline">
							{{ form_widget(form.allAgence) }}
							{{ form_label(form.allAgence) }}
						</div>
						<div class="form-check form-check-inline">
							{{ form_widget(form.allService) }}
							{{ form_label(form.allService) }}
						</div>
					</div>
					<div class="col-md-12">
						{{ form_widget(form.permissions, {'attr': {'class': 'form-select form-select-sm', 'style': 'height: 100px'}}) }}
					</div>
					<div class="col-auto mt-2">
						<button type="submit" class="btn btn-sm btn-success">Ajouter</button>
					</div>
				</div>
				{{ form_end(form) }}
			</div>
		</div>
	{% endif %}
</turbo-frame>
